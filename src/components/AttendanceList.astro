---
import Loader from './ui/Loader.astro'
---

<section>
    <table>
        <thead>
            <tr>
                <th scope='col'>Índice</th>
                <th scope='col'>Nombre</th>
                <th scope='col'>Confirma</th>
            </tr>
        </thead>
        <tbody id='items-list'> </tbody>
    </table>
    <Loader extraClass='ListLoader' />
</section>

<script>
    import { actions } from 'astro:actions'

    document.addEventListener('DOMContentLoaded', async () => {
        const loader = document.getElementById('loader') as HTMLDivElement
        const list = document.getElementById('items-list')

        const { data } = await actions.retriveList()

        const { rows } = JSON.parse(data ?? '{}')
        console.log(rows)

        if (rows.length > 1) {
            loader.style.display = 'none'
            rows.forEach((item: any[], index: number) => {
                const tr = document.createElement('tr')
                const tdName = document.createElement('td')
                const tdAttendance = document.createElement('td')
                const tdIndex = document.createElement('td')
                tdIndex.textContent = `${index + 1}`
                tdName.textContent = item[1]
                tdAttendance.textContent = item[2] === 1 ? 'Sí' : 'No'
                tr.appendChild(tdIndex)
                tr.appendChild(tdName)
                tr.appendChild(tdAttendance)
                tr.style.textAlign = 'center'
                list?.appendChild(tr)
            })
        }
    })
</script>

<style>
    th {
        text-align: center;
    }
</style>
